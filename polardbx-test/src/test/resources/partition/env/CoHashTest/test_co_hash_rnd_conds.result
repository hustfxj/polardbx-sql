## DISABLE_FAST_SQL_PARSER
CREATE TABLE `ch_rand_pruning_test1` (
`a` bigint(20) NOT NULL,
`b` bigint(20) NOT NULL,
`c` bigint(20) NOT NULL,
`d` bigint(20) NOT NULL,
`e` bigint(20) NOT NULL,
PRIMARY KEY (`a`, `b`, `c`),
KEY `auto_shard_key_b` USING BTREE (`b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY CO_HASH(`a`,`b`)
PARTITIONS 8;
CREATE TABLE `ch_rand_pruning_test2` (
`a` bigint(20) NOT NULL,
`b` bigint(20) NOT NULL,
`c` bigint(20) NOT NULL,
`d` bigint(20) NOT NULL,
`e` bigint(20) NOT NULL,
PRIMARY KEY (`a`, `b`, `c`),
KEY `auto_shard_key_b` USING BTREE (`b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY CO_HASH(`a`,`b`)
PARTITIONS 8;
insert into ch_rand_pruning_test1 (a,b,c,d,e) values (90,90,90,81713,41790),(91,91,91,29207,5178),
(92,92,92,14635,60637),(93,93,93,57022,62641),(94,94,94,27169,18807),(95,95,95,96225,91340),
(96,96,96,31268,51717),(97,97,97,36652,63240),(98,98,98,93283,9169),(99,99,99,90464,47586),
(190,190,190,59955,90628),(191,191,191,28980,50173),(192,192,192,32559,31999),(193,193,193,34461,45423),
(194,194,194,54697,12843),(195,195,195,98884,72649),(196,196,196,16166,39913),(197,197,197,1300,81389),
(198,198,198,93180,301),(199,199,199,35810,47132),(290,290,290,94414,41251),(291,291,291,38129,88636),
(292,292,292,35049,55396),(293,293,293,27442,24835),(294,294,294,5789,35995),(295,295,295,6153,17782),
(296,296,296,35222,15508),(297,297,297,21213,84533),(298,298,298,87400,58740),(299,299,299,5096,58037),
(390,390,390,39138,31054),(391,391,391,45248,39931),(392,392,392,30028,26010),(393,393,393,31130,38005),
(394,394,394,53423,27472),(395,395,395,60827,97763),(396,396,396,33971,11532),(397,397,397,53362,20353),
(398,398,398,9820,44474),(399,399,399,27878,3009),(490,490,490,67404,42211),(491,491,491,86162,110),
(492,492,492,21208,93903),(493,493,493,66001,20524),(494,494,494,18078,40308),(495,495,495,46834,4898),
(496,496,496,27495,91946),(497,497,497,99766,8095),(498,498,498,89114,41032),(499,499,499,55208,99224),
(590,590,590,5595,92666),(591,591,591,84816,39311),(592,592,592,70265,54245),(593,593,593,90130,15708),
(594,594,594,80117,8377),(595,595,595,69829,2219),(596,596,596,64,36338),(597,597,597,72297,70866),(598,598,598,9943,81605),
(599,599,599,19310,10875),(690,690,690,99431,46623),(691,691,691,27286,49171),(692,692,692,87930,64474),(693,693,693,31192,73105),
(694,694,694,36265,76075),(695,695,695,79329,3714),(696,696,696,33961,7771),(697,697,697,51125,60200),(698,698,698,10978,29148),
(699,699,699,70548,23437),(790,790,790,69756,31888),(791,791,791,62061,2180),(792,792,792,91769,26779),(793,793,793,27892,3421),
(794,794,794,43265,62558),(795,795,795,44494,8537),(796,796,796,35362,71317),(797,797,797,73176,56814),(798,798,798,24384,5233),
(799,799,799,53692,62868),(890,890,890,39665,10587),(891,891,891,17179,64720),(892,892,892,44644,3706),(893,893,893,58862,52949),
(894,894,894,86012,38654),(895,895,895,60429,30461),(896,896,896,37914,51190),(897,897,897,22440,9996),(898,898,898,73398,45668),
(899,899,899,91668,29592),(990,990,990,37478,67573),(991,991,991,99861,16673),(992,992,992,92672,95678),(993,993,993,48931,55362),
(994,994,994,12352,84267),(995,995,995,76644,8366),(996,996,996,65911,9552),(997,997,997,77860,77334),(998,998,998,74771,98430),
(999,999,999,64018,84866);
insert into ch_rand_pruning_test2 (a,b,c,d,e) values (90,90,90,81713,41790),(91,91,91,29207,5178),
(92,92,92,14635,60637),(93,93,93,57022,62641),(94,94,94,27169,18807),(95,95,95,96225,91340),
(96,96,96,31268,51717),(97,97,97,36652,63240),(98,98,98,93283,9169),(99,99,99,90464,47586),
(190,190,190,59955,90628),(191,191,191,28980,50173),(192,192,192,32559,31999),(193,193,193,34461,45423),
(194,194,194,54697,12843),(195,195,195,98884,72649),(196,196,196,16166,39913),(197,197,197,1300,81389),
(198,198,198,93180,301),(199,199,199,35810,47132),(290,290,290,94414,41251),(291,291,291,38129,88636),
(292,292,292,35049,55396),(293,293,293,27442,24835),(294,294,294,5789,35995),(295,295,295,6153,17782),
(296,296,296,35222,15508),(297,297,297,21213,84533),(298,298,298,87400,58740),(299,299,299,5096,58037),
(390,390,390,39138,31054),(391,391,391,45248,39931),(392,392,392,30028,26010),(393,393,393,31130,38005),
(394,394,394,53423,27472),(395,395,395,60827,97763),(396,396,396,33971,11532),(397,397,397,53362,20353),
(398,398,398,9820,44474),(399,399,399,27878,3009),(490,490,490,67404,42211),(491,491,491,86162,110),
(492,492,492,21208,93903),(493,493,493,66001,20524),(494,494,494,18078,40308),(495,495,495,46834,4898),
(496,496,496,27495,91946),(497,497,497,99766,8095),(498,498,498,89114,41032),(499,499,499,55208,99224),
(590,590,590,5595,92666),(591,591,591,84816,39311),(592,592,592,70265,54245),(593,593,593,90130,15708),
(594,594,594,80117,8377),(595,595,595,69829,2219),(596,596,596,64,36338),(597,597,597,72297,70866),(598,598,598,9943,81605),
(599,599,599,19310,10875),(690,690,690,99431,46623),(691,691,691,27286,49171),(692,692,692,87930,64474),(693,693,693,31192,73105),
(694,694,694,36265,76075),(695,695,695,79329,3714),(696,696,696,33961,7771),(697,697,697,51125,60200),(698,698,698,10978,29148),
(699,699,699,70548,23437),(790,790,790,69756,31888),(791,791,791,62061,2180),(792,792,792,91769,26779),(793,793,793,27892,3421),
(794,794,794,43265,62558),(795,795,795,44494,8537),(796,796,796,35362,71317),(797,797,797,73176,56814),(798,798,798,24384,5233),
(799,799,799,53692,62868),(890,890,890,39665,10587),(891,891,891,17179,64720),(892,892,892,44644,3706),(893,893,893,58862,52949),
(894,894,894,86012,38654),(895,895,895,60429,30461),(896,896,896,37914,51190),(897,897,897,22440,9996),(898,898,898,73398,45668),
(899,899,899,91668,29592),(990,990,990,37478,67573),(991,991,991,99861,16673),(992,992,992,92672,95678),(993,993,993,48931,55362),
(994,994,994,12352,84267),(995,995,995,76644,8366),(996,996,996,65911,9552),(997,997,997,77860,77334),(998,998,998,74771,98430),
(999,999,999,64018,84866);
select a,b,c,d from ch_rand_pruning_test1 t
where (((d = 10000) OR (b between 7000 and 8000)
  OR ((d > 40000) OR (a <= 700) OR ((a > 300 or (a=300 and c>40000) or (a=300 and c=40000) )))
  OR (b < 7000)) AND ((d > 70000) AND ((d > 60000) AND (a=400 and b=3000 and c=40000))
    AND ((d > 60000) AND (c < (select t1.c from ch_rand_pruning_test2 t1 order by c limit 6,1)))))
order by a,b,c limit 10;
a,b,c,d
select a,b,c,d from ch_rand_pruning_test1 t
where !(((d = 10000) OR (b between 7000 and 8000)
OR ((d > 40000) OR (a <= 700) OR ((a > 300 or (a=300 and c>40000) or (a=300 and c=40000) )))
OR (b < 7000)) AND ((d > 70000) AND ((d > 60000) AND (a=400 and b=3000 and c=40000))
AND ((d > 60000) AND (c < (select t1.c from ch_rand_pruning_test2 t1 order by c limit 6,1)))))
order by a,b,c limit 10;
a,b,c,d
90,90,90,81713
91,91,91,29207
92,92,92,14635
93,93,93,57022
94,94,94,27169
95,95,95,96225
96,96,96,31268
97,97,97,36652
98,98,98,93283
99,99,99,90464
select a,b,c,d from ch_rand_pruning_test1 t
  where (
    ( a in (93,96,97,98,99,190) or b in (97,98) )
  )
order by a,b,c limit 10;
a,b,c,d
93,93,93,57022
96,96,96,31268
97,97,97,36652
98,98,98,93283
99,99,99,90464
190,190,190,59955